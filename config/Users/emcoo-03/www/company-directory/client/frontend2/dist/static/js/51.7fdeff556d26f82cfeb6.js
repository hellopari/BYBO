webpackJsonp([51],{cz69:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),r=a.n(s),i=a("bOdI"),n=a.n(i),l=a("NYxO"),o={data:function(){var e=this;return{loading:!0,dialog:!1,dialog1:!1,form:!1,isLoading:!1,snackbarText:null,snackbar:!1,itemId:null,title:"chamber.btn.add_card",filters:{search:null,"organization.id":this.$route.params.organizationId,page:0,size:9},forms:{cardNumber:null,bankName:null,publishableKey:null,pecretKey:null,isActive:!1},totalDesserts:0,pagination:n()({sortBy:"createdAt"},"sortBy","isActive"),rules:{required:function(t){return!!t||e.$t("validation.required")}},limit:[10],headers:[{text:this.$t("chamber.payment.method"),align:"left",sortable:!1,value:"method"},{text:this.$t("user.user_education.job_description"),value:"description",sortable:!1},{text:this.$t("global.isActive"),value:"isActive"},{text:this.$t("chamber.know.time"),value:"createdAt"},{text:this.$t("chamber.know.operation"),value:"operation",sortable:!1}],desserts:[]}},watch:{pagination:{handler:function(){var e=this;if(this.filters.page!==this.pagination.page-1)this.filters.page=this.pagination.page-1,this.reloadTable();else{var t=this.pagination.sortBy;this.desserts=this.desserts.sort(function(a,s){var r=a[t],i=s[t];return e.pagination.descending?r<i?1:r>i?-1:0:r<i?-1:r>i?1:0})}},deep:!0}},mounted:function(){this.reloadTable()},methods:r()({},Object(l.b)(["snackbarStateChange"]),{reloadTable:function(){var e=this;this.loading=!0,null===this.filters.search&&delete this.filters.search,this.$http.get("manager/payment_managements",{params:this.filters,headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){e.desserts=t.data.content,e.totalDesserts=t.data.totalElements,e.loading=!1})},change:function(e){this.dialog=!0,this.itemId=e},onSubmit:function(){var e=this;this.isLoading=!0,this.forms["organization.id"]=this.$route.params.organizationId;var t=void 0;void 0===this.forms.id?t="store_message":(delete this.forms.organization,delete this.forms.createdAt,delete this.forms.lastModifiedAt,t="update_message","ONLINE"===this.forms.payType?(delete this.forms.cardNumber,delete this.forms.accountHolder,delete this.forms.bankName,delete this.forms.depositBank):(delete this.forms.pecretKey,delete this.forms.publishableKey,delete this.forms.accountHolder,delete this.forms.depositBank)),this.$http.put("manager/payment_managements",this.$serialize(this.forms),{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(a){e.snackbarStateChange({color:"success",text:e.$t("message."+t),snackbar:!0}),e.reloadTable(),e.dialog1=!1,e.isLoading=!1}).catch(function(t){e.isLoading=!1,e.snackbarStateChange({color:"error",text:t.data.message,snackbar:!0})})},edieDialog:function(e){this.forms=e,this.dialog1=!0,this.title="chamber.btn.edit_card"},setActive:function(e,t){var a=this;"ONLINE"!==e.payType||null!==e.publishableKey?"ONLINE"===e.payType||null!==e.cardNumber?this.$http.put("manager/payment_managements/set_active",this.$serialize({organizationId:this.$route.params.organizationId,paymentManagementId:e.id,flag:t}),{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(e){a.snackbarStateChange({color:"success",text:a.$t("message.update_message"),snackbar:!0}),a.isLoading=!1}).catch(function(e){a.isLoading=!1,a.snackbarStateChange({color:"error",text:error.data.message,snackbar:!0})}):this.snackbarStateChange({color:"error",text:"請綁定銀行卡信息",snackbar:!0}):this.snackbarStateChange({color:"error",text:"請綁定轉賬信息",snackbar:!0})}})},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-layout",{staticClass:"mx-4 mt-2",attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md3:"",sm6:""}},[a("v-text-field",{staticClass:"px3",attrs:{label:e.$t("global.search_text"),"prepend-icon":"search",px3:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.reloadTable()}},model:{value:e.filters.search,callback:function(t){e.$set(e.filters,"search",t)},expression:"filters.search"}})],1)],1),e._v(" "),a("v-data-table",{staticClass:"rtable rtable--flip elevation-1",attrs:{headers:e.headers,items:e.desserts,"no-data-text":e.$t("message.no_message"),pagination:e.pagination,"rows-per-page-items":e.limit,"total-items":e.totalDesserts,loading:e.loading},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",["ONLINE"===t.item.payType?a("span",[e._v("Stripe")]):a("span",[e._v(e._s(e.$t("global.transfer")))])]),e._v(" "),a("td",["ONLINE"===t.item.payType?a("span",[e._v(e._s(e.$t("global.payDes1")))]):a("span",[e._v(e._s(e.$t("global.payDes2")))])]),e._v(" "),a("td",{staticClass:"text-xs-left"},[a("v-switch",{attrs:{color:"primary"},on:{change:function(a){return e.setActive(t.item,t.item.isActive)}},model:{value:t.item.isActive,callback:function(a){e.$set(t.item,"isActive",a)},expression:"props.item.isActive"}})],1),e._v(" "),a("td",{staticClass:"text-xs-left"},[e._v(e._s(e._f("time")(t.item.createdAt)))]),e._v(" "),a("td",{staticClass:"text-md-center text-xs-left"},[a("v-btn",{attrs:{flat:"",small:""},on:{click:function(a){return e.edieDialog(t.item)}}},[null===t.item.publishableKey&&"ONLINE"===t.item.payType?a("span",{staticClass:"error--text"},[e._v(e._s(e.$t("global.nbinding")))]):e._e(),e._v(" "),null!==t.item.publishableKey&&"ONLINE"===t.item.payType?a("span",{staticClass:"success--text"},[e._v(e._s(e.$t("global.binding")))]):e._e(),e._v(" "),null===t.item.cardNumber&&"ONLINE"!==t.item.payType?a("span",{staticClass:"error--text"},[e._v(e._s(e.$t("global.nbinding")))]):e._e(),e._v(" "),null!==t.item.cardNumber&&"ONLINE"!==t.item.payType?a("span",{staticClass:"success--text"},[e._v(e._s(e.$t("global.binding")))]):e._e()])],1)]}}])}),e._v(" "),a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v(e._s(e.$t("global.deleteConfirmTitle")))]),e._v(" "),a("v-card-text",[e._v(e._s(e.$t("global.deleteConfirmText")))]),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"darken-1",flat:""},nativeOn:{click:function(t){e.dialog=!1}}},[e._v(e._s(e.$t("button.cancel")))]),e._v(" "),a("v-btn",{attrs:{color:"primary darken-1",flat:""},on:{click:function(t){return e.deletes()}}},[e._v(e._s(e.$t("button.confirm")))])],1)],1)],1)],1),e._v(" "),a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog1,callback:function(t){e.dialog1=t},expression:"dialog1"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"title"},[e._v(e._s(e.$t(e.title)))])]),e._v(" "),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-form",{ref:"form",model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},["ONLINE"===e.forms.payType?a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{color:"purple darken-2",label:"publishableKey",rules:[e.rules.required],clearable:""},model:{value:e.forms.publishableKey,callback:function(t){e.$set(e.forms,"publishableKey",t)},expression:"forms.publishableKey"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{color:"purple darken-2",label:"pecretKey",rules:[e.rules.required],clearable:""},model:{value:e.forms.pecretKey,callback:function(t){e.$set(e.forms,"pecretKey",t)},expression:"forms.pecretKey"}})],1)],1):a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{color:"purple darken-2",label:e.$t("chamber.payment.number"),rules:[e.rules.required],clearable:""},model:{value:e.forms.cardNumber,callback:function(t){e.$set(e.forms,"cardNumber",t)},expression:"forms.cardNumber"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{color:"purple darken-2",label:e.$t("chamber.payment.name"),rules:[e.rules.required],clearable:""},model:{value:e.forms.bankName,callback:function(t){e.$set(e.forms,"bankName",t)},expression:"forms.bankName"}})],1)],1)],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"darken-1",flat:""},nativeOn:{click:function(t){e.dialog1=!1}}},[e._v(e._s(e.$t("button.cancel")))]),e._v(" "),a("v-btn",{attrs:{color:"primary darken-1",disabled:!e.form,loading:e.isLoading,flat:""},nativeOn:{click:function(t){return e.onSubmit()}}},[e._v("\n            "+e._s(e.$t("button.save"))+"\n          ")])],1)],1)],1)],1)],1)},staticRenderFns:[]},d=a("VU/8")(o,c,!1,null,null,null);t.default=d.exports}});