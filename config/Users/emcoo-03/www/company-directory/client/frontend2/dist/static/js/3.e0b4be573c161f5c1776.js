webpackJsonp([3],{"1sCx":function(e,t){},BEs5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("fZjL"),n=a.n(r),i=a("Dd8w"),s=a.n(i),o=a("bTAJ"),l=a("NYxO"),d=(a("3f40"),a("4qOc"),a("+cgv"),a("G0J2")),c=(a("mtWM"),{components:{"my-upload":o.a,quillEditor:d.quillEditor},data:function(){var e=this;return{valid:!0,isLoading:!1,show:!1,imgDataUrl:null,i18n:"EN"===localStorage.getItem("i18n")?"en-us":"zh-cn",categories:[],eventCategoryId:null,approvals:["NONE","APPROVE"],editorOption:{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{color:[]},{background:[]}],["link","image"]],syntax:{highlight:function(e){return hljs.highlightAuto(e).value}}},placeholder:this.$t("chamber.know.content")},eventForm:{eventTickets:[],eventOrganizer:{organizationId:this.$route.params.organizationId,email:null,name:null,phone:null,description:null},event:{title:null,startedAt:null,status:"PUBLISHED",releasedAt:null,endedAt:null,personnelNumber:null,address:null,description:null}},rules:{required:function(t){return!!t||e.$t("validation.required")}}}},computed:s()({},Object(l.c)(["imagesToUpload"])),mounted:function(){this.reloadCategories(),this.eventForm.id||this.reloadCoc(),this.$route.params.eventId&&this.reloadFind()},methods:s()({},Object(l.b)(["snackbarStateChange"]),{reloadFind:function(){var e=this;this.$http.get("manager/events/"+this.$route.params.eventId,{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){e.eventForm.event.title=t.data.title,e.eventForm.id=t.data.id,e.eventForm.event.startedAt=t.data.startedAt,e.eventForm.event.endedAt=t.data.endedAt,e.eventForm.event.releasedAt=t.data.releasedAt,e.eventForm.event.status=t.data.status,e.eventForm.event.personnelNumber=t.data.personnelNumber,e.eventForm.event.address=t.data.address,e.eventForm.event.description=t.data.description,e.eventCategoryId=t.data.eventCategory.id,delete t.data.eventOrganizer.lastModifiedAt,delete t.data.eventOrganizer.lastModifiedBy,delete t.data.eventOrganizer.createdBy,delete t.data.eventOrganizer.createdAt,e.eventForm.eventOrganizer=t.data.eventOrganizer,delete t.data.eventTickets[0].createdBy,delete t.data.eventTickets[0].createdAt,delete t.data.eventTickets[0].lastModifiedBy,delete t.data.eventTickets[0].lastModifiedAt,e.eventForm.eventTickets=t.data.eventTickets,e.imgDataUrl=e.$fileUrl+"/public/uploads/o/company/event/"+t.data.id+"/"+t.data.eventFiles[0].key})},reloadCoc:function(){var e=this;this.$http.get("manager/organizations/"+this.$route.params.organizationId,{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){e.eventForm.eventOrganizer.phone=t.data.phone,e.eventForm.eventOrganizer.description=t.data.contacts,e.eventForm.eventOrganizer.name=t.data.name,e.eventForm.eventOrganizer.email=t.data.email})},reloadCategories:function(){var e=this;this.$http.get("public/event_categorys").then(function(t){e.categories=t.data.content})},cropSuccess:function(e,t){this.imgDataUrl=e},addTickets:function(e){e?this.eventForm.eventTickets.push({name:null,price:0,deleted:!0,quantity:0,approvalType:"NONE"}):this.eventForm.eventTickets.push({name:null,price:null,deleted:!1,quantity:0,approvalType:"NONE"})},deleteTickets:function(e){this.eventForm.eventTickets.splice(e,1)},onSubmit:function(){if(this.$refs.form.validate())if(this.isLoading=!0,this.eventForm.id)this.editEvent(),this.imagesToUpload.length>0&&this.editEventCover();else{if(0===this.imagesToUpload.length)return this.snackbarStateChange({color:"error",text:this.$t("chamber.placeholder.prompt.update_file_size_text"),snackbar:!0}),void(this.isLoading=!1);if(0===this.eventForm.eventTickets.length)return this.snackbarStateChange({color:"error",text:this.$t("global.selectType"),snackbar:!0}),void(this.isLoading=!1);this.addEvent(this.eventForm)}},addEvent:function(){for(var e=this,t=new FormData,a=0,r=this.imagesToUpload.length;a<r;a++)t.append(this.imagesToUpload[a].key,this.imagesToUpload[a].value,this.imagesToUpload[a].key+".png");t.append("organizationId",this.$route.params.organizationId),t.append("eventCategoryId",this.eventCategoryId),n()(this.eventForm).forEach(function(a){"eventTickets"===a?n()(e.eventForm[a]).forEach(function(r,n){t.append(a+"["+n+"].name",e.eventForm[a][n].name),t.append(a+"["+n+"].price",e.eventForm[a][n].price),t.append(a+"["+n+"].quantity",e.eventForm[a][n].quantity),t.append(a+"["+n+"].approvalType",e.eventForm[a][n].approvalType)}):n()(e.eventForm[a]).forEach(function(r){t.append(a+"."+r,e.eventForm[a][r])})}),this.$http.post("manager/events",t,{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){e.snackbarStateChange({color:"success",text:e.$t("message.store_message"),snackbar:!0}),e.$store.commit("clearImagesToUpload"),e.$store.commit("clearFilesToUpload"),e.isLoading=!1,e.$router.push({path:"/organization/"+e.$route.params.organizationId+"/events"})}).catch(function(t){e.snackbarStateChange({color:"error",text:t.data.message,snackbar:!0}),e.isLoading=!1})},editEvent:function(){var e=this;this.eventForm.eventCategoryId=this.eventCategoryId,this.eventForm["event.id"]=this.eventForm.id,this.eventForm.organizationId=this.$route.params.organizationId,this.$http.put("manager/events",this.$serialize(this.eventForm),{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){e.snackbarStateChange({color:"success",text:e.$t("message.update_message"),snackbar:!0}),e.$router.push({path:"/organization/"+e.$route.params.organizationId+"/events"}),e.isLoading=!1}).catch(function(t){e.snackbarStateChange({color:"error",text:t.data.message,snackbar:!0}),e.isLoading=!1})},editEventCover:function(){for(var e=this,t=new FormData,a=0,r=this.imagesToUpload.length;a<r;a++)t.append(this.imagesToUpload[a].key,this.imagesToUpload[a].value,this.imagesToUpload[a].key+".png");t.append("eventId",this.eventForm.id),this.$http.post("manager/event_files",t,{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){e.snackbarStateChange({color:"success",text:e.$t("message.update_message"),snackbar:!0}),e.$store.commit("clearImagesToUpload"),e.$store.commit("clearFilesToUpload"),e.isLoading=!1}).catch(function(t){e.snackbarStateChange({color:"error",text:t.data.message,snackbar:!0}),e.isLoading=!1})}})}),v={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"event-form"}},[r("v-form",{ref:"form",staticClass:"my-5",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-container",{attrs:{"grid-list-xl":"","text-xs-center":""}},[r("v-card",{staticClass:"pa-4"},[r("div",{staticClass:"card-header card-header-icon card-header-rose"},[r("div",{staticClass:"card-icon"},[r("v-icon",{staticClass:"white--text"},[e._v("local_activity")])],1),e._v(" "),r("h4",{staticClass:"card-title text-lg-left"},[r("font",{staticStyle:{"vertical-align":"inherit"}},[r("font",{staticStyle:{"vertical-align":"inherit"}},[r("router-link",{attrs:{to:"/organization/"+e.$route.params.organizationId+"/events"}},[e._v("\n                  "+e._s(e.$t("chamber.left.activity"))+"\n                ")]),e._v("\n                -\n              ")],1)],1),e._v(" "),r("small",{staticClass:"category"},[r("font",{staticStyle:{"vertical-align":"inherit"}},[r("font",{staticStyle:{"vertical-align":"inherit"}},[e._v(e._s(e.$t(e.$route.name))+" ")])],1)],1)],1)]),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"",sm6:"",md8:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required],label:e.$t("chamber.activity.name")},model:{value:e.eventForm.event.title,callback:function(t){e.$set(e.eventForm.event,"title",t)},expression:"eventForm.event.title"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[r("v-autocomplete",{attrs:{items:e.categories,"no-data-text":e.$t("message.no_message"),rules:[e.rules.required],color:"purple darken-2",label:e.$t("chamber.activity.category"),"item-text":"name","item-value":"id"},scopedSlots:e._u([{key:"item",fn:function(t){return[[r("v-list-tile-content",[r("v-list-tile-title",{attrs:{color:"#333"},domProps:{innerHTML:e._s(t.item.name)}})],1)]]}}]),model:{value:e.eventCategoryId,callback:function(t){e.eventCategoryId=t},expression:"eventCategoryId"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[r("vue-ctk-date-time-picker",{attrs:{id:"startedAt",format:"YYYY-MM-DD HH:mm:ss",formatted:"YYYY-MM-DD HH:mm:ss",label:e.$t("chamber.activity.startTimedAt"),color:"#2c7a90","enable-button-validate":""},model:{value:e.eventForm.event.startedAt,callback:function(t){e.$set(e.eventForm.event,"startedAt",t)},expression:"eventForm.event.startedAt"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[r("vue-ctk-date-time-picker",{attrs:{id:"endedAt",format:"YYYY-MM-DD HH:mm:ss",formatted:"YYYY-MM-DD HH:mm:ss",label:e.$t("chamber.activity.endTimedAt"),color:"#2c7a90","enable-button-validate":""},model:{value:e.eventForm.event.endedAt,callback:function(t){e.$set(e.eventForm.event,"endedAt",t)},expression:"eventForm.event.endedAt"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[r("vue-ctk-date-time-picker",{attrs:{format:"YYYY-MM-DD HH:mm:ss",formatted:"YYYY-MM-DD HH:mm:ss",label:e.$t("chamber.activity.signUpEndTimedAt"),color:"#2c7a90","enable-button-validate":""},model:{value:e.eventForm.event.releasedAt,callback:function(t){e.$set(e.eventForm.event,"releasedAt",t)},expression:"eventForm.event.releasedAt"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required],label:e.$t("chamber.activity.address")},model:{value:e.eventForm.event.address,callback:function(t){e.$set(e.eventForm.event,"address",t)},expression:"eventForm.event.address"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{type:"number",rules:[e.rules.required],color:"purple darken-2",label:e.$t("chamber.activity.scale"),hint:e.$t("global.post_activity_text")},model:{value:e.eventForm.event.personnelNumber,callback:function(t){e.$set(e.eventForm.event,"personnelNumber",t)},expression:"eventForm.event.personnelNumber"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"",md3:""}},[r("p",{staticClass:" text-xs-left mb-2"},[e._v(e._s(e.$t("chamber.create.news_cover")))]),e._v(" "),r("div",{staticClass:"fileinput fileinput-new text-center",attrs:{"data-provides":"fileinput"}},[r("div",{staticClass:"fileinput-new thumbnail"},[null===e.imgDataUrl?r("img",{staticStyle:{width:"100%"},attrs:{src:a("2zBX"),alt:"..."}}):r("img",{staticStyle:{width:"100%"},attrs:{src:e.imgDataUrl,alt:"..."}})]),e._v(" "),r("div",{staticClass:"fileinput-preview fileinput-exists thumbnail"}),e._v(" "),r("div",{staticClass:"text-xs-center"},[r("v-btn",{attrs:{round:"",color:"primary",dark:""},on:{click:function(t){e.show=!e.show}}},[e._v(e._s(e.$t("chamber.btn.file_update")))])],1),e._v(" "),r("my-upload",{ref:"file",attrs:{field:"file",width:640,height:400,"img-format":"png"},on:{"crop-success":e.cropSuccess},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})],1)]),e._v(" "),r("v-flex",{attrs:{md3:""}},[r("p",{staticClass:"mt-4  text-xs-left "},[e._v(e._s(e.$t("chamber.prompt.title")))]),e._v(" "),r("p",{staticClass:"text-xs-left "},[e._v(e._s(e.$t("chamber.prompt.update_file_size_text")))])])],1)],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("p",{staticClass:" text-xs-left mb-2"},[e._v(e._s(e.$t("global.ticket_information")))])]),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-layout",{staticClass:"px-2",attrs:{row:"",wrap:""}},[r("v-flex",{staticClass:"primary text-xs-left  white--text",attrs:{xs12:"",md3:""}},[e._v("\n                "+e._s(e.$t("global.ticket"))+"\n              ")]),e._v(" "),r("v-flex",{staticClass:"primary text-xs-left  white--text",attrs:{xs12:"",md3:""}},[e._v("\n                "+e._s(e.$t("chamber.activity.price"))+"\n              ")]),e._v(" "),r("v-flex",{staticClass:"primary text-xs-left white--text",attrs:{xs12:"",md2:""}},[e._v("\n                "+e._s(e.$t("chamber.activity.quantity"))+"\n              ")]),e._v(" "),r("v-flex",{staticClass:"primary text-xs-left white--text",attrs:{xs12:"",md3:""}},[e._v("\n                "+e._s(e.$t("global.auditSettings"))+"\n              ")]),e._v(" "),r("v-flex",{staticClass:"primary white--text",attrs:{xs12:"",md1:""}},[e._v("\n                "+e._s(e.$t("chamber.select.operation"))+"\n              ")])],1),e._v(" "),r("v-layout",{staticClass:"px-2 mb-5",attrs:{row:"",wrap:""}},[e._l(e.eventForm.eventTickets,function(t,a){return[r("v-flex",{attrs:{xs12:"",md3:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required],label:e.$t("global.inputName")},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",md3:""}},[r("v-text-field",{attrs:{color:"purple darken-2",disabled:0===t.price,min:"0",type:"number",label:e.$t("chamber.activity.price")},model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"item.price"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",md2:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required],min:"1",type:"number",label:e.$t("chamber.activity.quantity")},model:{value:t.quantity,callback:function(a){e.$set(t,"quantity",a)},expression:"item.quantity"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",md3:""}},[r("v-select",{attrs:{color:"purple darken-2",items:[{id:"NONE",name:e.$t("chamber.activity.none")},{id:"APPROVE",name:e.$t("chamber.activity.APPROVE")}],"item-text":"name","item-value":"id",label:e.$t("global.auditSettings"),rules:[e.rules.required],"persistent-hint":"","single-line":""},model:{value:t.approvalType,callback:function(a){e.$set(t,"approvalType",a)},expression:"item.approvalType"}})],1),e._v(" "),e.eventForm.id?e._e():r("v-flex",{attrs:{xs12:"",md1:""}},[r("v-btn",{attrs:{flat:"",icon:"",color:"primary"},on:{click:function(t){return e.deleteTickets(a)}}},[r("v-icon",[e._v("delete_forever")])],1)],1)]})],2),e._v(" "),e.eventForm.id?e._e():r("v-btn",{staticClass:"mb-5",attrs:{small:""},on:{click:function(t){return e.addTickets(!0)}}},[e._v("\n              "+e._s(e.$t("chamber.activity.addFreeTicket"))+"\n            ")]),e._v(" "),e.eventForm.id?e._e():r("v-btn",{staticClass:"mb-5 primary white--text",attrs:{small:""},on:{click:function(t){return e.addTickets(!1)}}},[e._v("\n              "+e._s(e.$t("chamber.activity.addTicket"))+"\n            ")])],1),e._v(" "),r("v-flex",{staticClass:"text-xs-left",attrs:{xs12:""}},[r("p",[e._v(e._s(e.$t("chamber.activity.content")))]),e._v(" "),r("quill-editor",{ref:"myTextEditor",attrs:{rules:[e.rules.required],options:e.editorOption},model:{value:e.eventForm.event.description,callback:function(t){e.$set(e.eventForm.event,"description",t)},expression:"eventForm.event.description"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[r("v-text-field",{attrs:{rules:[e.rules.required],label:e.$t("chamber.activity.sponsor_coc")},model:{value:e.eventForm.eventOrganizer.name,callback:function(t){e.$set(e.eventForm.eventOrganizer,"name",t)},expression:"eventForm.eventOrganizer.name"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[r("v-text-field",{attrs:{rules:[e.rules.required],label:e.$t("chamber.activity.sponsor")},model:{value:e.eventForm.eventOrganizer.description,callback:function(t){e.$set(e.eventForm.eventOrganizer,"description",t)},expression:"eventForm.eventOrganizer.description"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[r("v-text-field",{attrs:{rules:[e.rules.required],label:e.$t("chamber.create.phone")},model:{value:e.eventForm.eventOrganizer.phone,callback:function(t){e.$set(e.eventForm.eventOrganizer,"phone",t)},expression:"eventForm.eventOrganizer.phone"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[r("v-text-field",{attrs:{rules:[e.rules.required],label:e.$t("chamber.create.email")},model:{value:e.eventForm.eventOrganizer.email,callback:function(t){e.$set(e.eventForm.eventOrganizer,"email",t)},expression:"eventForm.eventOrganizer.email"}})],1)],1),e._v(" "),r("v-btn",{attrs:{flat:"",to:"/organization/"+e.$route.params.organizationId+"/events"}},[e._v(e._s(e.$t("button.cancel")))]),e._v(" "),r("v-btn",{attrs:{color:"indigo darken-1",disabled:!e.valid||!e.eventForm.event.description,loading:e.isLoading,flat:""},nativeOn:{click:function(t){return e.onSubmit()}}},[e._v(e._s(e.$t("button.save"))+"\n        ")])],1)],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(c,v,!1,function(e){a("1sCx")},null,null);t.default=m.exports}});