webpackJsonp([45],{JYKn:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("fZjL"),r=a.n(s),i=a("Xxa5"),o=a.n(i),n=a("exGp"),l=a.n(n),c=a("Dd8w"),d=a.n(c),u=a("bOdI"),p=a.n(u),m=a("bTAJ"),h=a("NYxO"),f={data:function(){var t,e=this;return t={countries:[1,2,3,4,5,6,7,8,9,10,11,12],loading:!0,dialog:!1,dialog1:!1,form:!1,isLoading:!1,show:!1,snackbarText:null,imgDataUrl:null,snackbar:!1},p()(t,"show",!1),p()(t,"itemId",null),p()(t,"title","chamber.btn.add_course"),p()(t,"filters",{search:null,"organization.id":this.$route.params.organizationId,page:0,pageSize:9}),p()(t,"forms",{url:null,order:null,title:null,type:"PLSTFORM"}),p()(t,"totalDesserts",0),p()(t,"totalPages",0),p()(t,"pagination",p()({sortBy:"createdAt"},"sortBy","order")),p()(t,"rules",{required:function(t){return!!t||e.$t("validation.required")},website:function(t){return/^(https?):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(t)||"Invalid website."}}),p()(t,"limit",[10]),p()(t,"headers",[{text:this.$t("chamber.position.image"),align:"left",sortable:!1,value:"image"},{text:this.$t("chamber.know.title"),align:"left",sortable:!1,value:"title"},{text:this.$t("chamber.know.link_address"),value:"url",sortable:!1},{text:this.$t("chamber.know.time"),value:"createdAt"},{text:this.$t("chamber.know.sort"),value:"order"},{text:this.$t("chamber.know.operation"),value:"operation",sortable:!1}]),p()(t,"desserts",[]),t},watch:{pagination:{handler:function(){var t=this,e=this.pagination.sortBy;this.desserts=this.desserts.sort(function(a,s){var r=a[e],i=s[e];return t.pagination.descending?r<i?1:r>i?-1:0:r<i?-1:r>i?1:0})},deep:!0}},computed:d()({},Object(h.c)(["imagesToUpload"])),mounted:function(){this.filters.page=void 0!==this.$route.query.page?Number(this.$route.query.page)-1:0,this.reloadTable()},components:{"my-upload":m.a},methods:d()({},Object(h.b)(["snackbarStateChange"]),{reloadTable:function(){var t=this;this.loading=!0,null===this.filters.search&&delete this.filters.search,this.$http.get("manager/slide_shows",{params:this.filters,headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(e){t.desserts=e.data.content,t.totalDesserts=e.data.totalElements,t.totalPages=e.data.totalPages,t.loading=!1})},cropSuccess:function(t,e){this.imgDataUrl=t},change:function(t){this.dialog=!0,this.itemId=t},deletes:function(){var t=this;this.$http.delete("manager/slide_shows/"+this.itemId,{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(e){t.snackbarStateChange({color:"success",text:t.$t("message.delete_success"),snackbar:!0}),t.dialog=!1,t.reloadTable()}).catch(function(e){t.snackbarStateChange({color:"error",text:e.data.message,snackbar:!0})})},onSubmit:function(){var t=this;return l()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoading=!0,t.forms["organization.id"]=t.$route.params.organizationId,void 0!==t.forms.id){e.next=12;break}if(0!==t.imagesToUpload.length||t.forms.id){e.next=8;break}t.isLoading=!1,t.snackbarStateChange({color:"error",text:"請上傳封面圖",snackbar:!0}),e.next=10;break;case 8:return e.next=10,t.addSliderShow();case 10:e.next=17;break;case 12:return e.next=14,t.editSliderShow();case 14:if(!(t.imagesToUpload.length>0)){e.next=17;break}return e.next=17,t.editSliderShowCover();case 17:case"end":return e.stop()}},e,t)}))()},addSliderShow:function(){var t=this;return l()(o.a.mark(function e(){var a,s,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new FormData,s=0,i=t.imagesToUpload.length;s<i;s++)a.append(t.imagesToUpload[s].key,t.imagesToUpload[s].value,t.imagesToUpload[s].key+".png");return r()(t.forms).forEach(function(e){a.append(e,t.forms[e])}),e.next=5,t.$http.post("manager/slide_shows",a,{headers:{"X-TENANT-ID":t.$route.params.organizationId}}).then(function(e){t.snackbarStateChange({color:"success",text:t.$t("message.store_message"),snackbar:!0}),t.reloadTable(),t.forms={},t.dialog1=!1,t.isLoading=!1}).catch(function(e){t.isLoading=!1,t.snackbarStateChange({color:"error",text:e.data.message,snackbar:!0})});case 5:case"end":return e.stop()}},e,t)}))()},editSliderShow:function(){var t=this;return l()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.put("manager/slide_shows",t.$serialize(t.forms),{headers:{"X-TENANT-ID":t.$route.params.organizationId}}).then(function(e){t.snackbarStateChange({color:"success",text:t.$t("message.update_message"),snackbar:!0}),t.reloadTable(),t.dialog1=!1,t.isLoading=!1}).catch(function(e){t.isLoading=!1,t.snackbarStateChange({color:"error",text:e.data.message,snackbar:!0})});case 2:case"end":return e.stop()}},e,t)}))()},editSliderShowCover:function(){var t=this;return l()(o.a.mark(function e(){var a,s,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new FormData,s=0,r=t.imagesToUpload.length;s<r;s++)a.append(t.imagesToUpload[s].key,t.imagesToUpload[s].value,t.imagesToUpload[s].key+".png");return a.append("slideShowId",t.forms.id),e.next=5,t.$http.post("manager/slide_shows/update_image",a,{headers:{"X-TENANT-ID":t.$route.params.organizationId}}).then(function(e){t.snackbarStateChange({color:"success",text:t.$t("message.update_message"),snackbar:!0}),t.reloadTable(),t.dialog1=!1,t.isLoading=!1}).catch(function(e){t.isLoading=!1,t.snackbarStateChange({color:"error",text:e.data.message,snackbar:!0})});case 5:case"end":return e.stop()}},e,t)}))()},edieDialog:function(t){this.forms.title=t.title,this.forms.url=t.url,this.forms.order=t.order,this.forms.id=t.id,this.imgDataUrl=this.$fileUrl+"/public/uploads/o/company/slideShow/"+t.id+"/"+t.key,this.dialog1=!0,this.title="chamber.btn.edit_course"},handleInput:function(t){this.pagination.page=t,this.$router.push({path:"/organization/"+this.$route.params.organizationId+"/sliderShow",query:{page:t}}),this.filters.page=t-1,this.reloadTable()}})},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-layout",{staticClass:"mx-4 mt-2",attrs:{row:"",wrap:"","align-center":"","fill-height":""}},[s("v-flex",{attrs:{md3:"",xs8:""}},[s("v-text-field",{staticClass:"px3",attrs:{label:t.$t("global.search_text"),"prepend-icon":"search",px3:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.reloadTable()}},model:{value:t.filters.search,callback:function(e){t.$set(t.filters,"search",e)},expression:"filters.search"}})],1),t._v(" "),s("v-flex",[s("v-btn",{staticClass:"pull-right",attrs:{color:"primary"},on:{click:function(e){t.dialog1=!0,t.title="chamber.btn.add_course",t.imgDataUrl=null}}},[t._v(t._s(t.$t("chamber.btn.add_course"))+"\n      ")])],1)],1),t._v(" "),s("v-data-table",{staticClass:"rtable rtable--flip elevation-1",attrs:{"hide-actions":"",headers:t.headers,items:t.desserts,"no-data-text":t.$t("message.no_message"),pagination:t.pagination,"rows-per-page-items":t.limit,"total-items":t.totalDesserts,loading:t.loading},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[s("td",{staticClass:"text-xs-left py-2"},[s("v-img",{staticClass:"hidden-xs-only",attrs:{src:t.$fileUrl+"/public/uploads/o/company/slideShow/"+e.item.id+"/"+e.item.key,"lazy-src":"https://picsum.photos/510/300?random","aspect-ratio":"1.7"}}),t._v(" "),s("img",{staticClass:"hidden-sm-and-up",staticStyle:{padding:"5px"},attrs:{src:""+t.$fileUrl+e.item.key,width:"80"}})],1),t._v(" "),s("td",{staticClass:"text-no-wrap  text-truncate"},[t._v(t._s(e.item.title))]),t._v(" "),s("td",{staticClass:"text-xs-left"},[s("a",{attrs:{href:""+e.item.url,target:"_blank"}},[t._v(t._s(e.item.url))])]),t._v(" "),s("td",{staticClass:"text-xs-left"},[t._v(t._s(t._f("time")(e.item.createdAt)))]),t._v(" "),s("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.order))]),t._v(" "),s("td",{staticClass:"text-xs-center"},[s("v-tooltip",{attrs:{top:""}},[s("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"primary"},on:{click:function(a){return t.edieDialog(e.item)}},slot:"activator"},[s("v-icon",{attrs:{size:"18"}},[t._v("edit")])],1),t._v(" "),s("span",[t._v(t._s(t.$t("button.edit")))])],1),t._v(" "),s("v-tooltip",{attrs:{top:""}},[s("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"error"},nativeOn:{click:function(a){return t.change(e.item.id)}},slot:"activator"},[s("v-icon",{attrs:{size:"18"}},[t._v("close")])],1),t._v(" "),s("span",[t._v(t._s(t.$t("button.delete")))])],1)],1)]}}])},[t._v(" "),s("template",{slot:"footer"},[s("td",{staticClass:"px-0",attrs:{colspan:t.headers.length+1}},[s("v-pagination",{staticClass:"pull-right my-2",attrs:{circle:"","total-visible":7,length:t.totalPages},on:{input:t.handleInput},model:{value:t.filters.page+1,callback:function(e){t.$set(t.filters,"page+1",e)},expression:"filters.page+1"}})],1)])],2),t._v(" "),s("v-layout",{attrs:{row:"","justify-center":""}},[s("v-dialog",{attrs:{"max-width":"290"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[t._v(t._s(t.$t("global.deleteConfirmTitle")))]),t._v(" "),s("v-card-text",[t._v(t._s(t.$t("global.deleteConfirmText")))]),t._v(" "),s("v-card-actions",[s("v-spacer"),t._v(" "),s("v-btn",{attrs:{color:"darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v(t._s(t.$t("button.cancel")))]),t._v(" "),s("v-btn",{attrs:{color:"primary darken-1",flat:""},on:{click:function(e){return t.deletes()}}},[t._v(t._s(t.$t("button.confirm")))])],1)],1)],1)],1),t._v(" "),s("v-layout",{attrs:{row:"","justify-center":""}},[s("v-dialog",{attrs:{"max-width":"800px"},model:{value:t.dialog1,callback:function(e){t.dialog1=e},expression:"dialog1"}},[s("v-card",[s("v-card-title",[s("span",{staticClass:"title"},[t._v(t._s(t.$t(t.title)))])]),t._v(" "),s("v-card-text",[s("v-container",{attrs:{"grid-list-md":""}},[s("v-form",{ref:"form",model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{attrs:{color:"purple darken-2",label:t.$t("chamber.know.title"),hint:t.$t("chamber.placeholder.course.title"),rules:[t.rules.required],clearable:""},model:{value:t.forms.title,callback:function(e){t.$set(t.forms,"title",e)},expression:"forms.title"}})],1),t._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs6:""}},[s("v-text-field",{attrs:{color:"purple darken-2",label:t.$t("chamber.know.link_address"),hint:t.$t("chamber.placeholder.course.link_address"),rules:[t.rules.required,t.rules.website],clearable:""},model:{value:t.forms.url,callback:function(e){t.$set(t.forms,"url",e)},expression:"forms.url"}})],1),t._v(" "),s("v-flex",{attrs:{xs6:""}},[s("v-text-field",{attrs:{color:"purple darken-2",label:t.$t("chamber.know.sort"),hint:t.$t("chamber.placeholder.course.sort"),rules:[t.rules.required],clearable:""},model:{value:t.forms.order,callback:function(e){t.$set(t.forms,"order",e)},expression:"forms.order"}})],1)],1)],1),t._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:"",md4:""}},[s("p",{staticClass:" text-xs-left mb-2"},[t._v(t._s(t.$t("chamber.create.news_cover")))]),t._v(" "),s("div",{staticClass:"fileinput fileinput-new text-center",attrs:{"data-provides":"fileinput"}},[s("div",{staticClass:"fileinput-new thumbnail"},[null===t.imgDataUrl?s("img",{staticStyle:{width:"100%"},attrs:{src:a("2zBX"),alt:"..."}}):s("img",{staticStyle:{width:"100%"},attrs:{src:t.imgDataUrl,alt:"..."}})]),t._v(" "),s("div",{staticClass:"fileinput-preview fileinput-exists thumbnail"}),t._v(" "),s("div",{staticClass:"text-xs-center"},[s("v-btn",{attrs:{round:"",color:"primary",dark:""},on:{click:function(e){t.show=!t.show}}},[t._v(t._s(t.$t("chamber.btn.file_update"))+"\n                          ")])],1),t._v(" "),s("my-upload",{ref:"file",attrs:{field:"file",width:1200,height:440,"img-format":"png"},on:{"crop-success":t.cropSuccess},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1)]),t._v(" "),s("v-flex",{staticClass:"ml-4",attrs:{md4:""}},[s("p",{staticClass:"mt-4  text-xs-left "},[t._v(t._s(t.$t("chamber.prompt.title")))]),t._v(" "),s("p",{staticClass:" text-xs-left "},[t._v(t._s(t.$t("chamber.prompt.update_file_size_text")))])])],1)],1)],1)],1)],1)],1),t._v(" "),s("v-card-actions",[s("v-spacer"),t._v(" "),s("v-btn",{attrs:{color:"darken-1",flat:""},nativeOn:{click:function(e){t.dialog1=!1,t.forms={type:"PLSTFORM"}}}},[t._v("\n            "+t._s(t.$t("button.cancel"))+"\n          ")]),t._v(" "),s("v-btn",{attrs:{color:"primary darken-1",disabled:!t.form,loading:t.isLoading,flat:""},nativeOn:{click:function(e){return t.onSubmit()}}},[t._v("\n            "+t._s(t.$t("button.save"))+"\n          ")])],1)],1)],1)],1)],1)},staticRenderFns:[]},g=a("VU/8")(f,v,!1,null,null,null);e.default=g.exports}});