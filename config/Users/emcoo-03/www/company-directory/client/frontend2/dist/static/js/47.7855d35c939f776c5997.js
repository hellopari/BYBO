webpackJsonp([47],{"i1q/":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("fZjL"),r=a.n(s),o=a("Xxa5"),i=a.n(o),n=a("exGp"),l=a.n(n),c=a("Dd8w"),d=a.n(c),u=a("NYxO"),p=(a("3f40"),a("4qOc"),a("+cgv"),a("G0J2")),m=a("bTAJ"),f={components:{quillEditor:p.quillEditor,"my-upload":m.a},data:function(){var t=this;return{countries:[1,2,3,4,5,6,7,8,9,10,11,12],loading:!0,dialog:!1,dialog1:!1,categories:[],imagesToUpload:[],imgDataUrl:null,form:!1,isLoading:!1,snackbarText:null,snackbar:!1,show:!1,itemId:null,title:"chamber.btn.add_know",filters:{search:null,"organization.id":this.$route.params.organizationId,page:0,size:9},editorOption:{modules:{toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{color:[]},{background:[]}],["link","image"]],syntax:{highlight:function(t){return hljs.highlightAuto(t).value}}},placeholder:this.$t("chamber.know.content")},forms:{content:null,description:null,compareAtPrice:null,sku:null,onSale:!0,productCategoryIds:null,price:null,name:null},totalDesserts:0,totalPages:0,pagination:{sortBy:"createdAt"},rules:{required:function(e){return!!e||t.$t("validation.required")}},limit:[10],headers:[{text:"sku",align:"left",sortable:!1},{text:this.$t("chamber.know.title"),align:"left",sortable:!1,value:"title"},{text:this.$t("chamber.know.price"),value:"createdAt"},{text:this.$t("chamber.know.compareAtPrice"),value:"compareAtPrice"},{text:this.$t("chamber.know.operation"),value:"operation",sortable:!1}],desserts:[]}},watch:{pagination:{handler:function(){var t=this,e=this.pagination.sortBy;this.desserts=this.desserts.sort(function(a,s){var r=a[e],o=s[e];return t.pagination.descending?r<o?1:r>o?-1:0:r<o?-1:r>o?1:0})},deep:!0}},mounted:function(){this.filters.page=void 0!==this.$route.query.page?Number(this.$route.query.page)-1:0,this.reloadTable(),this.reloadCategories()},methods:d()({},Object(u.b)(["snackbarStateChange"]),{reloadTable:function(){var t=this;return l()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,null===t.filters.search&&delete t.filters.search,e.next=4,t.$http.get("manager/products",{params:t.filters,headers:{"X-TENANT-ID":t.$route.params.organizationId}}).then(function(e){t.desserts=e.data.content,t.totalDesserts=e.data.totalElements,t.totalPages=e.data.totalPages,t.loading=!1});case 4:case"end":return e.stop()}},e,t)}))()},reloadCategories:function(){var t=this;this.$http.get("public/productCategory/category").then(function(e){t.categories=e.data.content})},open:function(){this.dialog1=!0,this.title="chamber.btn.add_know",this.imagesToUpload=[]},change:function(t){this.dialog=!0,this.itemId=t},deletes:function(){var t=this;this.$http.delete("manager/products/"+this.itemId,{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(e){t.snackbarStateChange({color:"success",text:t.$t("message.delete_success"),snackbar:!0}),t.dialog=!1,t.reloadTable()}).catch(function(e){t.snackbarStateChange({color:"error",text:e.data.message,snackbar:!0})})},deletesImage:function(t){var e=this;this.$http.delete("manager/products/"+t+"/destroy/upload_product_image",{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){e.snackbarStateChange({color:"success",text:e.$t("message.delete_success"),snackbar:!0}),e.dialog=!1,e.reloadTable()}).catch(function(t){e.snackbarStateChange({color:"error",text:t.data.message,snackbar:!0})})},removeImg:function(t){this.imagesToUpload[t].id&&this.deletesImage(this.imagesToUpload[t].id),this.imagesToUpload.splice(t,1)},onSubmit:function(){var t=this;return l()(i.a.mark(function e(){var a,s,o,n,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoading=!0,a=void 0,void 0,s=void 0,t.forms.productCategoryIds=t.forms.productCategoryIds.map(function(t){return t.id}),void 0===t.forms.id?(a="store_message","post",s="manager/products"):(delete t.forms.organization,delete t.forms.createdAt,delete t.forms.categories,a="update_message","put",s="manager/products/"+t.forms.id),o=new FormData,t.imagesToUpload.length>0)for(n=0,c=t.imagesToUpload.length;n<c;n++)void 0!==t.imagesToUpload[n].value&&o.append(t.imagesToUpload[n].key,t.imagesToUpload[n].value,t.imagesToUpload[n].key+".png");return r()(t.forms).forEach(function(e){o.append(e,t.forms[e])}),e.next=11,t.$http.post(s,o,{headers:{"X-TENANT-ID":t.$route.params.organizationId}}).then(function(){var e=l()(i.a.mark(function e(s){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.snackbarStateChange({color:"success",text:t.$t("message."+a),snackbar:!0}),t.imagesToUpload=[],t.$store.commit("clearImagesToUpload"),t.$store.commit("clearFilesToUpload"),e.next=6,t.reloadTable();case 6:t.dialog1=!1,t.isLoading=!1,t.forms={type:"STATUTES"};case 9:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){t.isLoading=!1,t.snackbarStateChange({color:"error",text:e,snackbar:!0})});case 11:case"end":return e.stop()}},e,t)}))()},cropSuccess:function(t){this.imagesToUpload.push(t)},edieDialog:function(t){var e=this;this.imagesToUpload=[],this.forms=t,this.forms.productCategoryIds=t.categories,t.productImage.length>0&&t.productImage.forEach(function(t){e.imagesToUpload.push({createImgUrl:e.$fileUrl+"/public/uploads/o/"+t.path,id:t.id})}),this.dialog1=!0,this.title="chamber.btn.edit_know"},handleInput:function(t){this.pagination.page=t,this.$router.push({path:"/organization/"+this.$route.params.organizationId+"/rules",query:{page:t}}),this.filters.page=t-1,this.reloadTable()}})},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-layout",{staticClass:"mx-4 mt-2",attrs:{row:"",wrap:"","fill-height":""}},[s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{staticClass:"px3",staticStyle:{width:"320px",float:"left"},attrs:{label:t.$t("global.search_text"),"prepend-icon":"search",px3:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.reloadTable()}},model:{value:t.filters.search,callback:function(e){t.$set(t.filters,"search",e)},expression:"filters.search"}}),t._v(" "),s("v-btn",{staticClass:"pull-right",staticStyle:{float:"right"},attrs:{color:"primary"},on:{click:t.open}},[t._v(t._s(t.$t("chamber.btn.add_know"))+"\n      ")])],1)],1),t._v(" "),s("v-data-table",{staticClass:"rtable rtable--flip elevation-1",attrs:{"hide-actions":"",headers:t.headers,items:t.desserts,"no-data-text":t.$t("message.no_message"),pagination:t.pagination,"rows-per-page-items":t.limit,"total-items":t.totalDesserts,loading:t.loading},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[s("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.sku))]),t._v(" "),s("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.name))]),t._v(" "),s("td",{staticClass:"text-xs-left"},[t._v("$HK "+t._s(e.item.price))]),t._v(" "),s("td",{staticClass:"text-xs-left"},[t._v("$HK "+t._s(e.item.compareAtPrice))]),t._v(" "),s("td",{staticClass:"text-xs-center"},[s("v-tooltip",{attrs:{top:""}},[s("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"primary"},on:{click:function(a){return t.edieDialog(e.item)}},slot:"activator"},[s("v-icon",{attrs:{size:"18"}},[t._v("edit")])],1),t._v(" "),s("span",[t._v(t._s(t.$t("button.edit")))])],1),t._v(" "),s("v-tooltip",{attrs:{top:""}},[s("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"error"},nativeOn:{click:function(a){return t.change(e.item.id)}},slot:"activator"},[s("v-icon",{attrs:{size:"18"}},[t._v("close")])],1),t._v(" "),s("span",[t._v(t._s(t.$t("button.delete")))])],1)],1)]}}])},[t._v(" "),s("template",{slot:"footer"},[s("td",{staticClass:"px-0",attrs:{colspan:t.headers.length+1}},[s("v-pagination",{staticClass:"pull-right my-2",attrs:{circle:"","total-visible":7,length:t.totalPages},on:{input:t.handleInput},model:{value:t.filters.page+1,callback:function(e){t.$set(t.filters,"page+1",e)},expression:"filters.page+1"}})],1)])],2),t._v(" "),s("v-layout",{attrs:{row:"","justify-center":""}},[s("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[t._v(t._s(t.$t("global.deleteConfirmTitle")))]),t._v(" "),s("v-card-text",[t._v(t._s(t.$t("global.deleteConfirmText")))]),t._v(" "),s("v-card-actions",[s("v-spacer"),t._v(" "),s("v-btn",{attrs:{color:"darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v(t._s(t.$t("button.cancel")))]),t._v(" "),s("v-btn",{attrs:{color:"primary darken-1",flat:""},on:{click:function(e){return t.deletes()}}},[t._v(t._s(t.$t("button.confirm")))])],1)],1)],1)],1),t._v(" "),s("v-layout",{attrs:{row:"","justify-center":""}},[s("v-dialog",{attrs:{"max-width":"800px"},model:{value:t.dialog1,callback:function(e){t.dialog1=e},expression:"dialog1"}},[s("v-card",[s("v-card-title",[s("span",{staticClass:"title"},[t._v(t._s(t.$t(t.title)))])]),t._v(" "),s("v-card-text",[s("v-container",{attrs:{"grid-list-md":""}},[s("v-form",{ref:"form",model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{attrs:{type:"text",color:"purple darken-2",label:"sku",rules:[t.rules.required],clearable:""},model:{value:t.forms.sku,callback:function(e){t.$set(t.forms,"sku",e)},expression:"forms.sku"}})],1),t._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{attrs:{color:"purple darken-2",label:t.$t("chamber.know.title"),rules:[t.rules.required],clearable:""},model:{value:t.forms.name,callback:function(e){t.$set(t.forms,"name",e)},expression:"forms.name"}})],1),t._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-select",{attrs:{items:t.categories,"return-object":"","item-text":"name","item-value":"id",chips:"",multiple:"","no-data-text":t.$t("message.no_message"),label:t.$t("chamber.know.categories")},model:{value:t.forms.productCategoryIds,callback:function(e){t.$set(t.forms,"productCategoryIds",e)},expression:"forms.productCategoryIds"}})],1),t._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{attrs:{label:t.$t("chamber.know.price"),rules:[t.rules.required],type:"number",min:0,color:"purple darken-2",prefix:"$HK"},model:{value:t.forms.price,callback:function(e){t.$set(t.forms,"price",e)},expression:"forms.price"}})],1),t._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{attrs:{label:t.$t("chamber.know.compareAtPrice"),rules:[t.rules.required],type:"number",min:0,color:"purple darken-2",prefix:"$HK"},model:{value:t.forms.compareAtPrice,callback:function(e){t.$set(t.forms,"compareAtPrice",e)},expression:"forms.compareAtPrice"}})],1),t._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("p",{staticClass:" text-xs-left mb-2"},[t._v(t._s(t.$t("chamber.create.news_cover")))]),t._v(" "),s("v-layout",{attrs:{row:""}},t._l(t.imagesToUpload,function(e,r){return s("v-flex",{key:r,attrs:{md2:""}},[s("div",{staticClass:"fileinput fileinput-new text-center",staticStyle:{position:"relative"},attrs:{"data-provides":"fileinput"}},[s("v-btn",{staticStyle:{position:"absolute",right:"-25px",top:"-30px"},attrs:{flat:"",icon:"",color:"pink"},on:{click:function(e){return t.removeImg(r)}}},[s("v-icon",[t._v("close")])],1),t._v(" "),s("div",{staticClass:"fileinput-new thumbnail"},[null===e.createImgUrl?s("img",{staticStyle:{width:"100%"},attrs:{src:a("2zBX"),alt:"..."}}):s("img",{staticStyle:{width:"100%"},attrs:{src:e.createImgUrl,alt:"..."}})]),t._v(" "),s("div",{staticClass:"fileinput-preview fileinput-exists thumbnail"})],1)])}),1),t._v(" "),s("div",{staticClass:"text-xs-center"},[s("v-btn",{attrs:{round:"",color:"primary",dark:""},on:{click:function(e){t.show=!t.show}}},[t._v(t._s(t.$t("chamber.btn.file_update"))+"\n                        ")])],1),t._v(" "),s("my-upload",{ref:"file",attrs:{field:"file",width:600,height:400,multiple:!0,"img-format":"png"},on:{imagesToUpload:t.cropSuccess},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1)],1)],1),t._v(" "),s("v-flex",{staticClass:"text-xs-left",attrs:{xs12:""}},[s("p",[t._v("簡介")]),t._v(" "),s("quill-editor",{ref:"myTextEditor",attrs:{rules:[t.rules.required],options:t.editorOption},model:{value:t.forms.description,callback:function(e){t.$set(t.forms,"description",e)},expression:"forms.description"}})],1),t._v(" "),s("v-flex",{staticClass:"text-xs-left",attrs:{xs12:""}},[s("p",[t._v(t._s(t.$t("chamber.know.content")))]),t._v(" "),s("quill-editor",{ref:"myTextEditor",attrs:{rules:[t.rules.required],options:t.editorOption},model:{value:t.forms.content,callback:function(e){t.$set(t.forms,"content",e)},expression:"forms.content"}})],1)],1)],1)],1)],1),t._v(" "),s("v-card-actions",[s("v-spacer"),t._v(" "),s("v-btn",{attrs:{color:"darken-1",flat:""},nativeOn:{click:function(e){t.dialog1=!1,t.forms={type:"STATUTES"}}}},[t._v("\n            "+t._s(t.$t("button.cancel"))+"\n          ")]),t._v(" "),s("v-btn",{attrs:{color:"primary darken-1",disabled:!t.form||!t.forms.content,loading:t.isLoading,flat:""},nativeOn:{click:function(e){return t.onSubmit()}}},[t._v(t._s(t.$t("button.save"))+"\n          ")])],1)],1)],1)],1)],1)},staticRenderFns:[]},g=a("VU/8")(f,v,!1,null,null,null);e.default=g.exports}});