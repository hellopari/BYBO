webpackJsonp([56],{HjP3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Dd8w"),s=r.n(a),o=(r("7+uW"),r("NYxO")),n=(r("3f40"),r("4qOc"),r("+cgv"),r("G0J2")),i={components:{quillEditor:n.quillEditor},data:function(){var e=this;return{e1:0,form:!1,form1:!1,isLoading:!1,show1:!1,memberGroups:[],friends:[],editorOption:{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{color:[]},{background:[]}],["link","image"]],syntax:{highlight:function(e){return hljs.highlightAuto(e).value}}},placeholder:this.$t("chamber.know.content")},isUpdating:!1,forms:{subject:null,recipientEmail:null,content:null,fromEmail:null,fromName:null,status:"SEND",memberGroupIds:[],"organization.id":this.$route.params.organizationId},formSetting:{username:null,host:null,port:null,fromEmail:null,fromName:null,password:null,active:!0,isAuth:!0,"organization.id":this.$route.params.organizationId},rules:{email:function(t){return(t||"").match(/@/)||e.$t("validation.email")},required:function(t){return!!t||e.$t("validation.required")}}}},mounted:function(){this.reloadGroups(),this.reloadSettings()},methods:s()({},Object(o.b)(["snackbarStateChange"]),{reloadGroups:function(){var e=this;this.$http.get("manager/member_groups",{params:{"organization.id":this.$route.params.organizationId,isDefault:!1},headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){e.memberGroups=t.data.map(function(e){return e.memberGroup})})},reloadSettings:function(){var e=this;this.$http.get("manager/email_relays",{params:{"organization.id":this.$route.params.organizationId},headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){t.data.content.length>0&&(e.formSetting=t.data.content[0],e.e1=2,e.formSetting["organization.id"]=e.$route.params.organizationId,delete e.formSetting.createdAt,delete e.formSetting.lastModifiedAt)})},onSubmit:function(){var e=this;this.isLoading=!0;var t=new URLSearchParams;this.friends.length>0?t.append("memberGroupIds",this.friends.join(",")):t.append("memberGroupIds",""),t.append("organization.id",this.$route.params.organizationId),t.append("status","SEND"),t.append("subject",this.forms.subject),t.append("fromEmail",this.forms.fromEmail),t.append("fromName",this.forms.fromName),t.append("content",this.forms.content),this.$http.post("manager/mass_emails",t,{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){e.snackbarStateChange({color:"success",text:e.$t("message.store_message"),snackbar:!0}),e.e1=3,e.friends=[],e.isLoading=!1}).catch(function(t){e.isLoading=!1,e.snackbarStateChange({color:"error",text:t.data.message,snackbar:!0})})},onSubmitSetting:function(){var e=this;this.isLoading=!0;var t=void 0===this.formSetting.id?"store_message":"update_message";this.$http.post("manager/email_relays",this.$serialize(this.formSetting),{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(r){e.snackbarStateChange({color:"success",text:e.$t("message."+t),snackbar:!0}),e.e1=2,e.isLoading=!1}).catch(function(t){e.isLoading=!1,e.snackbarStateChange({color:"error",text:t.data.message,snackbar:!0})})},remove:function(e){var t=this.friends.findIndex(function(t){return t===e});t>=0&&this.friends.splice(t,1)}})},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-stepper",{model:{value:e.e1,callback:function(t){e.e1=t},expression:"e1"}},[r("v-stepper-header",[r("v-stepper-step",{attrs:{complete:e.e1>1,step:"1"}},[e._v(e._s(e.$t("chamber.left.smtpSetting"))+" 1")]),e._v(" "),r("v-divider"),e._v(" "),r("v-stepper-step",{attrs:{complete:e.e1>2,step:"2"}},[e._v(e._s(e.$t("chamber.left.email"))+" 2")]),e._v(" "),r("v-divider"),e._v(" "),r("v-stepper-step",{attrs:{step:"3"}},[e._v(e._s(e.$t("message.store_message"))+" 3")])],1),e._v(" "),r("v-stepper-items",[r("v-stepper-content",{attrs:{step:"1"}},[r("v-form",{ref:"form",model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[r("v-container",{attrs:{"grid-list-xl":"","text-xs-center":""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xl6:"",md8:"","offset-xl3":"","offset-md2":"",xs12:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required],label:e.$t("chamber.member.from_name"),clearable:""},model:{value:e.formSetting.fromName,callback:function(t){e.$set(e.formSetting,"fromName",t)},expression:"formSetting.fromName"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required,e.rules.email],label:e.$t("chamber.member.from_email"),clearable:""},model:{value:e.formSetting.fromEmail,callback:function(t){e.$set(e.formSetting,"fromEmail",t)},expression:"formSetting.fromEmail"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required],label:e.$t("chamber.member.host"),clearable:""},model:{value:e.formSetting.host,callback:function(t){e.$set(e.formSetting,"host",t)},expression:"formSetting.host"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required],label:e.$t("chamber.member.port"),clearable:""},model:{value:e.formSetting.port,callback:function(t){e.$set(e.formSetting,"port",t)},expression:"formSetting.port"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required],label:e.$t("chamber.member.username"),clearable:""},model:{value:e.formSetting.username,callback:function(t){e.$set(e.formSetting,"username",t)},expression:"formSetting.username"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"purple darken-2","append-icon":e.show1?"visibility_off":"visibility",type:"password",rules:[e.rules.required],label:e.$t("chamber.member.password"),type:e.show1?"text":"password",counter:""},on:{"click:append":function(t){e.show1=!e.show1}},model:{value:e.formSetting.password,callback:function(t){e.$set(e.formSetting,"password",t)},expression:"formSetting.password"}})],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary darken-1",disabled:!e.form,loading:e.isLoading,flat:""},nativeOn:{click:function(t){return e.onSubmitSetting()}}},[e._v(e._s(e.$t("button.save"))+"\n              ")])],1)],1)],1)],1)],1),e._v(" "),r("v-stepper-content",{attrs:{step:"2"}},[r("v-form",{ref:"form",model:{value:e.form1,callback:function(t){e.form1=t},expression:"form1"}},[r("v-container",{attrs:{"grid-list-xl":"","text-xs-center":""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xl6:"",md8:"","offset-xl3":"","offset-md2":"",xs12:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required],label:e.$t("chamber.member.send_email_title"),clearable:""},model:{value:e.forms.subject,callback:function(t){e.$set(e.forms,"subject",t)},expression:"forms.subject"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required],label:e.$t("chamber.member.from_name"),clearable:""},model:{value:e.forms.fromName,callback:function(t){e.$set(e.forms,"fromName",t)},expression:"forms.fromName"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"purple darken-2",rules:[e.rules.required,e.rules.email],label:e.$t("chamber.member.from_email"),clearable:""},model:{value:e.forms.fromEmail,callback:function(t){e.$set(e.forms,"fromEmail",t)},expression:"forms.fromEmail"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-autocomplete",{attrs:{disabled:e.isUpdating,items:e.memberGroups,"no-data-text":e.$t("message.no_message"),hint:e.$t("global.groups_text"),box:"",chips:"",color:"purple darken-2",label:e.$t("chamber.member.select_item"),"item-text":"name","item-value":"id",multiple:""},scopedSlots:e._u([{key:"selection",fn:function(t){return[r("v-chip",{staticClass:"chip--select-multi",attrs:{selected:t.selected,close:""},on:{input:function(r){return e.remove(t.item.id)}}},[r("v-avatar",{staticClass:"purple white--text"},[e._v("\n                        "+e._s(t.item.name.slice(0,1).toUpperCase())+"\n                      ")]),e._v("\n                      "+e._s(t.item.name)+"\n                    ")],1)]}},{key:"item",fn:function(t){return[[r("v-list-tile-content",[r("v-list-tile-title",{attrs:{color:"#333"},domProps:{innerHTML:e._s(t.item.name)}})],1)]]}}]),model:{value:e.friends,callback:function(t){e.friends=t},expression:"friends"}}),e._v(" "),r("p",{staticClass:"error--text caption text-xs-left"},[e._v(e._s(e.$t("global.groups_text")))])],1),e._v(" "),r("v-flex",{staticClass:"text-xs-left",attrs:{xs12:""}},[r("p",{staticClass:"text-xs-left"},[e._v(e._s(e.$t("chamber.know.content")))]),e._v(" "),r("quill-editor",{ref:"myTextEditor",attrs:{rules:[e.rules.required],options:e.editorOption},model:{value:e.forms.content,callback:function(t){e.$set(e.forms,"content",t)},expression:"forms.content"}})],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"darken-1",flat:""},on:{click:function(t){e.e1=1}}},[e._v(e._s(e.$t("button.cancel")))]),e._v(" "),r("v-btn",{attrs:{color:"primary darken-1",disabled:!e.form1||!e.forms.content,loading:e.isLoading,flat:""},nativeOn:{click:function(t){return e.onSubmit()}}},[e._v(e._s(e.$t("button.save"))+"\n              ")])],1)],1)],1)],1)],1),e._v(" "),r("v-stepper-content",{attrs:{step:"3"}},[r("div",{staticClass:"my-5 text-xs-center"},[r("v-icon",{attrs:{size:"100",color:"primary"}},[e._v("check_circle")]),e._v(" "),r("p",{staticClass:"title"},[e._v(e._s(e.$t("message.store_message")))]),e._v(" "),r("v-btn",{attrs:{color:"primary"},on:{click:function(t){e.e1=2,e.forms={subject:null,recipientEmail:null,content:null,fromEmail:null,fromName:null,status:"SEND",memberGroupIds:[],"organization.id":e.$route.params.organizationId}}}},[e._v("\n          "+e._s(e.$t("global.continue"))+"\n        ")])],1)])],1)],1)},staticRenderFns:[]},m=r("VU/8")(i,l,!1,null,null,null);t.default=m.exports}});