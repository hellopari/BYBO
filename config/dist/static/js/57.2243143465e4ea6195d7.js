webpackJsonp([57],{KvZE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Xxa5"),i=a.n(s),r=a("exGp"),n=a.n(r),o=a("bOdI"),l=a.n(o),c=a("Dd8w"),d=a.n(c),m=a("NYxO"),u=(a("OMJi"),a("3f40"),a("4qOc"),a("+cgv"),a("G0J2")),p={components:{quillEditor:u.quillEditor},data:function(){var t=this;return{isUpdating:!1,memberGroups:[],memberships:[],friends:[],friends1:[],loading:!0,dialog:!1,dialog1:!1,replayLoading:!1,form:!1,isLoading:!1,snackbarText:null,snackbar:!1,itemId:null,title:"chamber.btn.add_notice",filters:{search:null,"organization.id":this.$route.params.organizationId,isDefault:!1,page:0,size:9},editorOption:{modules:{toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{color:[]},{background:[]}],["link","image"]],syntax:{highlight:function(t){return hljs.highlightAuto(t).value}}},placeholder:this.$t("chamber.know.content")},forms:{content:null,membershipIds:null,memberGroupIds:null,publishAt:null,isSendEmail:!1,browseRight:null,title:null},i:d()({},this.forms),totalDesserts:0,totalPages:0,pagination:l()({sortBy:"createdAt"},"sortBy","lastModifiedAt"),rules:{required:function(e){return!!e||t.$t("validation.required")}},limit:[9],headers:[{text:this.$t("chamber.know.title"),align:"left",sortable:!1,value:"title"},{text:this.$t("chamber.know.coc"),value:"coc",sortable:!1},{text:this.$t("cocShow.news.release_time"),value:"createdAt"},{text:this.$t("chamber.know.update_time"),value:"lastModifiedAt"},{text:this.$t("chamber.know.operation"),value:"operation",sortable:!1}],desserts:[]}},watch:{pagination:{handler:function(){var t=this,e=this.pagination.sortBy;this.desserts=this.desserts.sort(function(a,s){var i=a[e],r=s[e];return t.pagination.descending?i<r?1:i>r?-1:0:i<r?-1:i>r?1:0})},deep:!0}},mounted:function(){this.filters.page=void 0!==this.$route.query.page?Number(this.$route.query.page)-1:0,this.reloadTable()},methods:d()({},Object(m.b)(["snackbarStateChange"]),{reloadTable:function(){var t=this;this.loading=!0,null===this.filters.search&&delete this.filters.search,this.$http.get("manager/organizations/"+this.$route.params.organizationId+"/announcements",{params:this.filters,headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(e){t.desserts=e.data.content,t.totalDesserts=e.data.totalElements,t.totalPages=e.data.totalPages,t.loading=!1})},reloadGroups:function(){var t=this;this.$http.get("manager/member_groups",{params:{"organization.id":this.$route.params.organizationId,isDefault:!1},headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(e){t.memberGroups=e.data.map(function(t){return t.memberGroup})})},reloadMemberships:function(){var t=this;this.$http.get("manager/memberships",{params:{"organization.id":this.$route.params.organizationId,isDefault:!1},headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(e){t.memberships=e.data.content})},change:function(t){this.dialog=!0,this.itemId=t},deletes:function(){var t=this;this.$http.delete("manager/organizations/"+this.$route.params.organizationId+"/announcements/"+this.itemId,{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(e){t.snackbarStateChange({color:"success",text:t.$t("message.delete_success"),snackbar:!0}),t.dialog=!1,t.reloadTable()}).catch(function(e){t.snackbarStateChange({color:"error",text:e.data.message,snackbar:!0})})},replay:function(t){var e=this;this.replayLoading=!0,this.$http.post("manager/organizations/"+this.$route.params.organizationId+"/announcements/resendEmail",this.$serialize({announcementId:t}),{headers:{"X-TENANT-ID":this.$route.params.organizationId}}).then(function(t){e.snackbarStateChange({color:"success",text:e.$t("message.update_message"),snackbar:!0}),e.replayLoading=!1}).catch(function(t){e.replayLoading=!1,e.snackbarStateChange({color:"error",text:t.data.message,snackbar:!0})})},onSubmit:function(){var t=this;return n()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,t.forms["organization.id"]=t.$route.params.organizationId,a=void 0,void 0===t.forms.id?(a="store_message",t.forms.publishAt=t.$moment(new Date)):(delete t.forms.lastModifiedAt,delete t.forms.createdAt,delete t.forms.organization,delete t.forms.memberships,delete t.forms.memberGroups,a="update_message"),t.friends.length>0&&"APPOINT"===t.forms.browseRight?t.forms.memberGroupIds=t.friends.join(","):(delete t.forms.memberGroupIds,t.friends=[]),t.friends1.length>0&&"APPOINT"===t.forms.browseRight?t.forms.membershipIds=t.friends1.join(","):(delete t.forms.membershipIds,t.friends1=[]),e.next=8,t.$http.post("manager/organizations/"+t.$route.params.organizationId+"/announcements",t.$serialize(t.forms),{headers:{"X-TENANT-ID":t.$route.params.organizationId}}).then(function(e){t.snackbarStateChange({color:"success",text:t.$t("message."+a),snackbar:!0}),t.reloadTable(),t.friends=[],t.friends1=[],t.dialog1=!1,t.isLoading=!1}).catch(function(e){t.isLoading=!1,t.snackbarStateChange({color:"error",text:e.data.message,snackbar:!0})});case 8:case"end":return e.stop()}},e,t)}))()},openDialog:function(){this.dialog1=!0,0===this.memberGroups.length&&this.reloadGroups(),0===this.memberships.length&&this.reloadMemberships(),this.title="chamber.btn.add_notice",this.forms={}},edieDialog:function(t){this.forms=t,this.forms.memberGroups&&(this.friends=this.forms.memberGroups.map(function(t){return t.id})),this.forms.memberships&&(this.friends1=this.forms.memberships.map(function(t){return t.id})),this.dialog1=!0,this.title="chamber.btn.edit_notice",0===this.memberGroups.length&&this.reloadGroups(),0===this.memberships.length&&this.reloadMemberships()},remove:function(t){var e=this.friends.findIndex(function(e){return e===t});e>=0&&this.friends.splice(e,1)},removeMemberships:function(t){var e=this.friends1.findIndex(function(e){return e===t});e>=0&&this.friends1.splice(e,1)},handleInput:function(t){this.pagination.page=t,this.$router.push({path:"/organization/"+this.$route.params.organizationId+"/announcements",query:{page:t}}),this.filters.page=t-1,this.reloadTable()}})},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-layout",{staticClass:"mx-4 mt-2",attrs:{row:"",wrap:"","align-center":"","fill-height":""}},[a("v-flex",{attrs:{md3:"",sm6:""}},[a("v-text-field",{staticClass:"px3",attrs:{label:t.$t("global.search_text"),"prepend-icon":"search",px3:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.reloadTable()}},model:{value:t.filters.search,callback:function(e){t.$set(t.filters,"search",e)},expression:"filters.search"}})],1),t._v(" "),a("v-flex",{attrs:{md1:"",sm2:"","offset-sm4":"","offset-md8":""}},[a("v-btn",{attrs:{color:"primary"},on:{click:function(e){return t.openDialog()}}},[t._v(t._s(t.$t("chamber.btn.add_notice")))])],1)],1),t._v(" "),a("v-data-table",{staticClass:"rtable rtable--flip elevation-1",attrs:{"hide-actions":"",headers:t.headers,items:t.desserts,"no-data-text":t.$t("message.no_message"),pagination:t.pagination,"rows-per-page-items":t.limit,"total-items":t.totalDesserts,loading:t.loading},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[a("td",[a("router-link",{attrs:{to:{path:"/company/notice-detail",query:{id:e.item.organization.id,noticeId:e.item.id}},target:"_blank"}},[t._v(t._s(e.item.title)+"\n        ")])],1),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.organization.name))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(t._f("time")(e.item.createdAt)))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(t._f("time")(e.item.lastModifiedAt)))]),t._v(" "),a("td",{staticClass:"text-xs-center"},[a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",loading:t.replayLoading,flat:"",icon:"",color:"purple darken-2"},on:{click:function(a){return t.replay(e.item.id)}},slot:"activator"},[a("v-icon",{attrs:{size:"18"}},[t._v("replay")])],1),t._v(" "),a("span",[t._v(t._s(t.$t("button.replay")))])],1),t._v(" "),a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"primary"},on:{click:function(a){return t.edieDialog(e.item)}},slot:"activator"},[a("v-icon",{attrs:{size:"18"}},[t._v("edit")])],1),t._v(" "),a("span",[t._v(t._s(t.$t("button.edit")))])],1),t._v(" "),a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"error"},nativeOn:{click:function(a){return t.change(e.item.id)}},slot:"activator"},[a("v-icon",{attrs:{size:"18"}},[t._v("close")])],1),t._v(" "),a("span",[t._v(t._s(t.$t("button.delete")))])],1)],1)]}}])},[t._v(" "),a("template",{slot:"footer"},[a("td",{staticClass:"px-0",attrs:{colspan:t.headers.length+1}},[a("v-pagination",{staticClass:"pull-right my-2",attrs:{circle:"","total-visible":7,length:t.totalPages},on:{input:t.handleInput},model:{value:t.filters.page+1,callback:function(e){t.$set(t.filters,"page+1",e)},expression:"filters.page+1"}})],1)])],2),t._v(" "),a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v(t._s(t.$t("global.deleteConfirmTitle")))]),t._v(" "),a("v-card-text",[t._v(t._s(t.$t("global.deleteConfirmText")))]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v(t._s(t.$t("button.cancel")))]),t._v(" "),a("v-btn",{attrs:{color:"primary darken-1",flat:""},on:{click:function(e){return t.deletes()}}},[t._v(t._s(t.$t("button.confirm")))])],1)],1)],1)],1),t._v(" "),a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{"max-width":"800px"},model:{value:t.dialog1,callback:function(e){t.dialog1=e},expression:"dialog1"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"title"},[t._v(t._s(t.$t(t.title)))])]),t._v(" "),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-form",{ref:"form",model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{color:"purple darken-2",label:t.$t("chamber.know.title"),rules:[t.rules.required],clearable:""},model:{value:t.forms.title,callback:function(e){t.$set(t.forms,"title",e)},expression:"forms.title"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:""}},[a("div",{staticClass:"grey--text"},[t._v(t._s(t.$t("chamber.know.jurisdiction")))]),t._v(" "),a("v-radio-group",{attrs:{rules:[t.rules.required],row:""},model:{value:t.forms.browseRight,callback:function(e){t.$set(t.forms,"browseRight",e)},expression:"forms.browseRight"}},[a("v-radio",{attrs:{label:t.$t("global.true_public"),color:"primary",value:"PUBLIC"}}),t._v(" "),a("v-radio",{attrs:{label:t.$t("global.false_public"),color:"purple darken-2",value:"PRIVATE"}}),t._v(" "),a("v-radio",{attrs:{label:t.$t("global.APPOINT"),color:"red",value:"APPOINT"}})],1)],1),t._v(" "),"APPOINT"===t.forms.browseRight?a("v-flex",{attrs:{xs12:""}},[a("v-flex",{staticClass:"px-0",attrs:{xs12:""}},[a("v-flex",{staticClass:"px-0",attrs:{xs12:""}},[a("v-autocomplete",{attrs:{disabled:t.isUpdating,items:t.memberships,rules:[t.rules.required],"no-data-text":t.$t("message.no_message"),box:"",chips:"",color:"primary",label:t.$t("global.select_memberShips"),"item-text":"name","item-value":"id",multiple:""},scopedSlots:t._u([{key:"selection",fn:function(e){return[a("v-chip",{staticClass:"chip--select-multi",attrs:{selected:e.selected,close:""},on:{input:function(a){return t.removeMemberships(e.item.id)}}},[a("v-avatar",{staticClass:"primary white--text"},[t._v("\n                              "+t._s(e.item.name.slice(0,1).toUpperCase())+"\n                            ")]),t._v("\n                            "+t._s(e.item.name)+"\n                          ")],1)]}},{key:"item",fn:function(e){return[[a("v-list-tile-content",[a("v-list-tile-title",{attrs:{color:"#333"},domProps:{innerHTML:t._s(e.item.name)}})],1)]]}}],null,!1,106857104),model:{value:t.friends1,callback:function(e){t.friends1=e},expression:"friends1"}})],1)],1)],1):t._e(),t._v(" "),"APPOINT"===t.forms.browseRight?a("v-flex",{attrs:{xs12:""}},[a("v-flex",{staticClass:"px-0",attrs:{xs12:""}},[a("v-flex",{staticClass:"px-0",attrs:{xs12:""}},[a("v-autocomplete",{attrs:{disabled:t.isUpdating,items:t.memberGroups,rules:[t.rules.required],"no-data-text":t.$t("message.no_message"),hint:t.$t("global.groups_text"),box:"",chips:"",color:"purple darken-2",label:t.$t("chamber.member.select_item"),"item-text":"name","item-value":"id",multiple:""},scopedSlots:t._u([{key:"selection",fn:function(e){return[a("v-chip",{staticClass:"chip--select-multi",attrs:{selected:e.selected,close:""},on:{input:function(a){return t.remove(e.item.id)}}},[a("v-avatar",{staticClass:"purple white--text"},[t._v("\n                              "+t._s(e.item.name.slice(0,1).toUpperCase())+"\n                            ")]),t._v("\n                            "+t._s(e.item.name)+"\n                          ")],1)]}},{key:"item",fn:function(e){return[[a("v-list-tile-content",[a("v-list-tile-title",{attrs:{color:"#333"},domProps:{innerHTML:t._s(e.item.name)}})],1)]]}}],null,!1,761686274),model:{value:t.friends,callback:function(e){t.friends=e},expression:"friends"}}),t._v(" "),a("p",{staticClass:"error--text caption"},[t._v(t._s(t.$t("global.groups_text")))])],1)],1)],1):t._e(),t._v(" "),a("v-flex",{staticClass:"text-xs-left",attrs:{xs12:""}},[a("p",[t._v(t._s(t.$t("chamber.know.content")))]),t._v(" "),a("quill-editor",{ref:"myTextEditor",attrs:{rules:[t.rules.required],options:t.editorOption},model:{value:t.forms.content,callback:function(e){t.$set(t.forms,"content",e)},expression:"forms.content"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-checkbox",{attrs:{color:"purple darken-2",label:t.$t("global.isSendEmail")},model:{value:t.forms.isSendEmail,callback:function(e){t.$set(t.forms,"isSendEmail",e)},expression:"forms.isSendEmail"}})],1)],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"darken-1",flat:""},nativeOn:{click:function(e){t.dialog1=!1,t.forms={}}}},[t._v(t._s(t.$t("button.cancel")))]),t._v(" "),a("v-btn",{attrs:{color:"primary darken-1",disabled:!t.form||!t.forms.content,loading:t.isLoading,flat:""},nativeOn:{click:function(e){return t.onSubmit()}}},[t._v(t._s(t.$t("button.save"))+"\n          ")])],1)],1)],1)],1)],1)},staticRenderFns:[]},h=a("VU/8")(p,f,!1,null,null,null);e.default=h.exports}});